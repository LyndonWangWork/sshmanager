# SSH密钥导出功能说明

## 功能概述

SSH密钥管理器现在支持完善的导出功能，用户可以选择不同的文件格式和导出范围，将密钥保存到本地。

## 导出方式

### 1. 批量导出
在密钥管理页面，点击右上角的"导出密钥"按钮，可以批量导出密钥。

#### 导出范围选项：
- **导出所有密钥**：导出应用中的全部密钥
- **导出选中的密钥**：导出特定选择的密钥（功能准备中）

### 2. 单密钥导出
在密钥卡片上，点击右上角菜单中的"导出密钥"选项，可以导出单个密钥。

## 支持的导出格式

### 1. JSON格式 (.json) ✅ 完全支持
**适用场景**：应用备份和恢复
**文件结构**：
```json
{
  "version": "1.0",
  "exported_at": "2025-01-26T10:30:00.000Z",
  "keys": [
    {
      "id": "unique-key-id",
      "name": "my-github-key",
      "key_type": "Ed25519",
      "key_size": 256,
      "comment": "user@hostname",
      "public_key": "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5...",
      "private_key": "[REDACTED]",
      "fingerprint": "SHA256:...",
      "created_at": "2025-01-26T10:00:00.000Z",
      "last_used": null
    }
  ]
}
```

### 2. OpenSSH格式 ✅ 完全支持
**适用场景**：直接在系统SSH中使用
**文件结构**：
- 公钥文件：`key_name.pub`
- 私钥文件：`key_name`（无扩展名）

### 3. PEM格式 ✅ 完全支持
**适用场景**：通用密钥格式，兼容多种工具
**文件结构**：包含密钥信息和元数据的文本文件

## 安全选项

### 私钥包含设置
用户可以选择是否在导出文件中包含私钥内容：

- **不包含私钥**（推荐）：私钥字段显示为 `[REDACTED]`，更安全
- **包含私钥**：导出完整的密钥对，便于迁移但需注意安全

⚠️ **安全提醒**：包含私钥的导出文件应妥善保管，避免泄露。

## 导出预览功能

在导出前，用户可以在对话框中预览导出内容：
- JSON格式：显示数据结构预览
- OpenSSH格式：显示将生成的文件列表
- PEM格式：显示格式化的密钥信息

## 文件命名规则

### 自动命名
- JSON格式：`ssh_keys_YYYY-MM-DD.json`
- OpenSSH格式：`key_name.pub` 和 `key_name`
- PEM格式：`ssh_keys_YYYY-MM-DD.pem`

### 多密钥导出
当导出多个密钥为OpenSSH格式时：
- 第一个密钥：`filename.pub` 和 `filename`
- 其他密钥：`filename_key_2.pub` 和 `filename_key_2`

## 使用步骤

### 批量导出步骤：
1. 进入密钥管理页面
2. 点击右上角"导出密钥"按钮
3. 选择导出范围（所有密钥或选中密钥）
4. 选择导出格式（JSON/OpenSSH/PEM）
5. 设置是否包含私钥
6. 预览导出内容
7. 点击"导出密钥"按钮下载

### 单密钥导出步骤：
1. 在密钥卡片上点击右上角菜单按钮
2. 选择"导出密钥"
3. 在弹出的导出对话框中进行设置
4. 点击"导出密钥"按钮下载

## 技术说明

### 浏览器下载
目前使用浏览器的下载功能，文件会保存到用户的默认下载文件夹中。

### 格式兼容性
- JSON格式：可重新导入到本应用
- OpenSSH格式：兼容标准SSH客户端（如OpenSSH、PuTTY等）
- PEM格式：兼容多种密钥管理工具

### 后续改进计划
- [ ] 集成文件保存对话框，让用户选择保存位置
- [ ] 支持更多导出格式
- [ ] 添加密钥选择功能用于批量导出
- [ ] 支持加密导出文件

## 常见问题

**Q: 导出的文件在哪里？**
A: 文件会下载到浏览器的默认下载文件夹中。

**Q: 可以导出多个密钥到一个文件吗？**
A: 是的，JSON和PEM格式支持多密钥导出到单个文件，OpenSSH格式会为每个密钥生成单独的文件。

**Q: 导出的文件安全吗？**
A: 如果选择不包含私钥，导出文件是安全的。如果包含私钥，请妥善保管导出文件。

**Q: 可以重新导入导出的文件吗？**
A: JSON格式的导出文件可以重新导入到应用中，其他格式主要用于系统集成。