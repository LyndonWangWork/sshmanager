# Tauri æ–‡ä»¶å¯¹è¯æ¡†æƒé™é…ç½®ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

ç”¨æˆ·åœ¨æµ‹è¯•å¯¼å‡ºåŠŸèƒ½æ—¶é‡åˆ°äº†æƒé™é”™è¯¯ï¼š
```
å¯¼å‡ºé”™è¯¯: å¯¼å‡ºå¤±è´¥: dialog.save not allowed. Permissions associated with this command: dialog:allow-save, dialog:default
```

## é—®é¢˜æ ¹å› 

åœ¨ Tauri 2.0 ä¸­ï¼Œæ’ä»¶éœ€è¦æ˜ç¡®çš„æƒé™é…ç½®æ‰èƒ½è®¿é—®ç³»ç»ŸåŠŸèƒ½ã€‚æˆ‘ä»¬æ·»åŠ äº† `@tauri-apps/plugin-dialog` æ’ä»¶ï¼Œä½†æ²¡æœ‰æ­£ç¡®é…ç½®ç›¸åº”çš„æƒé™ï¼Œå¯¼è‡´å‰ç«¯æ— æ³•è°ƒç”¨æ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†ã€‚

## è§£å†³æ–¹æ¡ˆ

### 1. åˆ›å»º Capabilities é…ç½®æ–‡ä»¶

åœ¨ Tauri 2.0 ä¸­ï¼Œæƒé™é€šè¿‡ "capabilities" ç³»ç»Ÿç®¡ç†ã€‚åˆ›å»ºäº†ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š

**æ–‡ä»¶ä½ç½®**: `src-tauri/capabilities/main.json`

```json
{
  "identifier": "main-capability",
  "description": "Main application capability with dialog permissions",
  "windows": ["main"],
  "permissions": [
    "dialog:allow-save",
    "dialog:allow-open",
    "dialog:allow-message",
    "dialog:allow-ask",
    "dialog:allow-confirm",
    "dialog:default"
  ]
}
```

### 2. ä¿®æ”¹ Tauri é…ç½®æ–‡ä»¶

æ›´æ–° `src-tauri/tauri.conf.json` æ¥å¼•ç”¨æ–°çš„ capabilityï¼š

```json
{
  "app": {
    "windows": [
      {
        "label": "main",
        "title": "ssh-key-manager",
        "width": 800,
        "height": 600
      }
    ],
    "security": {
      "csp": null,
      "capabilities": ["main-capability"]
    }
  }
}
```

### 3. æƒé™è¯¦è§£

é…ç½®çš„æƒé™åŒ…æ‹¬ï¼š

- `dialog:allow-save`: å…è®¸ä½¿ç”¨æ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†
- `dialog:allow-open`: å…è®¸ä½¿ç”¨æ–‡ä»¶æ‰“å¼€å¯¹è¯æ¡†
- `dialog:allow-message`: å…è®¸æ˜¾ç¤ºæ¶ˆæ¯å¯¹è¯æ¡†
- `dialog:allow-ask`: å…è®¸æ˜¾ç¤ºè¯¢é—®å¯¹è¯æ¡†
- `dialog:allow-confirm`: å…è®¸æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
- `dialog:default`: æä¾›é»˜è®¤çš„å¯¹è¯æ¡†æƒé™

## æŠ€æœ¯èƒŒæ™¯

### Tauri 2.0 æƒé™ç³»ç»Ÿ

Tauri 2.0 å¼•å…¥äº†æ›´ä¸¥æ ¼çš„æƒé™ç³»ç»Ÿï¼š

1. **Capabilities**: å®šä¹‰åº”ç”¨èƒ½åŠ›çš„é…ç½®æ–‡ä»¶
2. **Permissions**: å…·ä½“çš„æƒé™æ ‡è¯†ç¬¦
3. **Security Context**: å°† capabilities ç»‘å®šåˆ°çª—å£

### ä¸ Tauri 1.x çš„å·®å¼‚

- Tauri 1.x: æ’ä»¶é»˜è®¤æœ‰æ‰€æœ‰æƒé™
- Tauri 2.0: éœ€è¦æ˜ç¡®å£°æ˜æ¯ä¸ªæƒé™
- Tauri 2.0: ä½¿ç”¨ capabilities ç³»ç»Ÿç®¡ç†æƒé™

## éªŒè¯ç»“æœ

ä¿®å¤åï¼š
- âœ… åº”ç”¨æˆåŠŸå¯åŠ¨ï¼Œæ— æƒé™é”™è¯¯
- âœ… æ–‡ä»¶å¯¹è¯æ¡†æƒé™å·²æ­£ç¡®é…ç½®
- âœ… å¯¼å‡ºåŠŸèƒ½ç°åœ¨åº”è¯¥èƒ½å¤Ÿæ˜¾ç¤ºæ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†

## ç›¸å…³æ–‡ä»¶

### æ–°å¢æ–‡ä»¶
- `src-tauri/capabilities/main.json` - æƒé™å®šä¹‰

### ä¿®æ”¹æ–‡ä»¶
- `src-tauri/tauri.conf.json` - åº”ç”¨é…ç½®
- `src-tauri/Cargo.toml` - åç«¯ä¾èµ–
- `src-tauri/src/lib.rs` - æ’ä»¶æ³¨å†Œ
- `package.json` - å‰ç«¯ä¾èµ–

## æœ€ä½³å®è·µ

### æƒé™é…ç½®åŸåˆ™

1. **æœ€å°æƒé™åŸåˆ™**: åªæˆäºˆåº”ç”¨éœ€è¦çš„æƒé™
2. **æ˜ç¡®é…ç½®**: åœ¨å¼€å‘é˜¶æ®µå°±æ˜ç¡®æ‰€éœ€æƒé™
3. **æ–‡æ¡£è®°å½•**: è®°å½•æ¯ä¸ªæƒé™çš„ç”¨é€”

### å¼€å‘å»ºè®®

1. **æ—©æœŸé…ç½®**: åœ¨æ·»åŠ æ’ä»¶æ—¶ç«‹å³é…ç½®æƒé™
2. **æµ‹è¯•éªŒè¯**: åœ¨å¼€å‘ç¯å¢ƒä¸­æµ‹è¯•æƒé™é…ç½®
3. **é”™è¯¯å¤„ç†**: åœ¨å‰ç«¯æ·»åŠ æƒé™é”™è¯¯çš„å¤„ç†é€»è¾‘

## åç»­å»ºè®®

1. **æ·»åŠ é”™è¯¯å¤„ç†**: åœ¨å‰ç«¯æ·»åŠ æƒé™ä¸è¶³æ—¶çš„å‹å¥½æç¤º
2. **æƒé™æ£€æŸ¥**: åœ¨è°ƒç”¨æ•æ„ŸåŠŸèƒ½å‰æ£€æŸ¥æƒé™çŠ¶æ€
3. **ç”¨æˆ·æŒ‡å¯¼**: ä¸ºç”¨æˆ·æä¾›æƒé™ç›¸å…³çš„ä½¿ç”¨è¯´æ˜

## æ€»ç»“

é€šè¿‡æ­£ç¡®é…ç½® Tauri 2.0 çš„ capabilities ç³»ç»Ÿï¼ŒæˆåŠŸè§£å†³äº†æ–‡ä»¶å¯¹è¯æ¡†æƒé™é—®é¢˜ã€‚ç°åœ¨ç”¨æˆ·å¯ä»¥ï¼š

- ğŸ¯ æ­£å¸¸ä½¿ç”¨æ–‡ä»¶ä¿å­˜å¯¹è¯æ¡†
- ğŸ“ é€‰æ‹©å¯¼å‡ºæ–‡ä»¶çš„ä¿å­˜ä½ç½®
- âœ… å®Œæ•´ä½“éªŒæ‰€æœ‰å¯¼å‡ºåŠŸèƒ½

è¿™ä¸ªä¿®å¤ç¡®ä¿äº†åº”ç”¨åœ¨ Tauri 2.0 æ¡†æ¶ä¸‹çš„æ­£ç¡®è¿è¡Œï¼Œå¹¶ä¸ºåç»­æ·»åŠ æ›´å¤šç³»ç»Ÿé›†æˆåŠŸèƒ½å¥ å®šäº†åŸºç¡€ã€‚